<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Exmplr Hypotheses</title>
  <meta name="description" content="A public, prospective registry of AI drug repurposing predictions with frozen slates, falsification criteria, and quarterly outcome tracking.">
  <style>
    :root {
      color-scheme: light dark;
      --bg: #0b1220;
      --card: #121b2f;
      --text: #e6edf7;
      --muted: #a9b6cc;
      --accent: #58a6ff;
      --border: #2b3a55;
      --ok: #3fb950;
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f7f9fc;
        --card: #ffffff;
        --text: #0b1220;
        --muted: #4a5872;
        --accent: #0b63d1;
        --border: #d7e0ef;
        --ok: #1b7f3b;
      }
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    .container {
      max-width: 1060px;
      margin: 0 auto;
      padding: 28px 18px 48px;
    }
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 14px;
    }
    .brand {
      font-weight: 700;
      letter-spacing: 0.2px;
    }
    .toplinks {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    h1, h2 { line-height: 1.2; margin: 0 0 12px; }
    h1 { font-size: clamp(28px, 4vw, 44px); }
    h2 { font-size: clamp(20px, 2.2vw, 28px); margin-top: 34px; }
    h3 { margin: 14px 0 8px; font-size: 17px; }
    p { margin: 0 0 14px; color: var(--muted); }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .hero {
      background: linear-gradient(160deg, color-mix(in srgb, var(--card) 90%, var(--accent) 10%), var(--card));
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 22px;
    }
    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }
    .btn {
      display: inline-block;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 12px;
      background: color-mix(in srgb, var(--card) 88%, var(--accent) 12%);
      color: var(--text);
      font-weight: 600;
    }
    .btn.primary {
      border-color: color-mix(in srgb, var(--accent) 65%, var(--border) 35%);
      background: color-mix(in srgb, var(--accent) 24%, var(--card) 76%);
    }
    .kpis {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 16px;
    }
    .kpi {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      background: color-mix(in srgb, var(--card) 92%, var(--accent) 8%);
    }
    .kpi .label { display: block; font-size: 12px; color: var(--muted); }
    .kpi .value { display: block; font-size: 22px; font-weight: 700; margin-top: 4px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }
    .card {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 14px;
      background: var(--card);
      transition: transform .12s ease, border-color .12s ease;
    }
    .card:hover {
      transform: translateY(-1px);
      border-color: color-mix(in srgb, var(--accent) 45%, var(--border) 55%);
    }
    .query-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px;
      margin: 10px 0 14px;
    }
    .query-actions {
      display: flex;
      gap: 8px;
      align-items: end;
    }
    label {
      display: block;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 4px;
    }
    select, input {
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 10px;
      background: var(--card);
      color: var(--text);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }
    .table-wrap { overflow-x: auto; }
    th, td {
      text-align: left;
      border-bottom: 1px solid var(--border);
      padding: 8px 6px;
      vertical-align: top;
    }
    tbody tr:hover { background: color-mix(in srgb, var(--card) 92%, var(--accent) 8%); }
    th { color: var(--muted); font-weight: 600; }
    .small { font-size: 13px; color: var(--muted); }
    .chip-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 8px 0 10px;
    }
    .chip {
      border: 1px solid var(--border);
      border-radius: 999px;
      padding: 5px 10px;
      background: color-mix(in srgb, var(--card) 95%, var(--accent) 5%);
      color: var(--text);
      font-size: 13px;
      cursor: pointer;
    }
    .chip.active {
      border-color: color-mix(in srgb, var(--accent) 65%, var(--border) 35%);
      background: color-mix(in srgb, var(--accent) 22%, var(--card) 78%);
    }
    ul { margin: 8px 0 0 18px; padding: 0; }
    li { margin: 6px 0; color: var(--muted); }
    .pill {
      display: inline-block;
      border: 1px solid color-mix(in srgb, var(--ok) 60%, var(--border) 40%);
      color: var(--ok);
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      margin-bottom: 10px;
    }
    footer {
      margin-top: 28px;
      border-top: 1px solid var(--border);
      padding-top: 14px;
      color: var(--muted);
      font-size: 14px;
    }
    code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 13px;
      background: color-mix(in srgb, var(--card) 80%, var(--text) 20%);
      padding: 2px 5px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <main class="container">
    <div class="topbar">
      <div class="brand">Exmplr Hypotheses</div>
      <div class="toplinks">
        <a href="docs/SCOREBOARD.md">Scoreboard</a>
        <a href="docs/REPLICATION.md">Replication</a>
        <a href="slates/2026-Q1/">Q1 Slate</a>
      </div>
    </div>
    <section class="hero">
      <span class="pill">Prospective hypothesis registry</span>
      <h1>Exmplr Hypotheses</h1>
      <p>
        We freeze drug repurposing predictions before outcomes are observed, then track what happens next.
        Successes and failures are both published.
      </p>
      <div class="actions">
        <a class="btn primary" href="docs/SCOREBOARD.md">View scoreboard</a>
        <a class="btn" href="slates/2026-Q1/">Browse Q1 slate</a>
        <a class="btn" href="drafts/01_introducing_hypothesis_registry.md">Read intro</a>
      </div>
      <div class="kpis">
        <div class="kpi"><span class="label">Frozen</span><span class="value">2026-02-09</span></div>
        <div class="kpi"><span class="label">Diseases</span><span class="value">7</span></div>
        <div class="kpi"><span class="label">Predictions</span><span class="value">350</span></div>
        <div class="kpi"><span class="label">High-tier enrichment</span><span class="value">1.70x</span></div>
      </div>
    </section>

    <h2>What is frozen</h2>
    <div class="grid">
      <article class="card">
        <strong>Immutable slates</strong>
        <ul>
          <li>Predictions are timestamped snapshots with deterministic fingerprints.</li>
          <li>Past predictions are never edited, added, or removed.</li>
        </ul>
      </article>
      <article class="card">
        <strong>Falsifiable claims</strong>
        <ul>
          <li>Every prediction has a time-bounded criterion that can be disproven.</li>
          <li>Top-tier predictions have stricter success windows.</li>
        </ul>
      </article>
      <article class="card">
        <strong>Outcome tracking</strong>
        <ul>
          <li>Outcomes are appended, not rewritten.</li>
          <li>Low-signal and negative outcomes are retained for auditability.</li>
        </ul>
      </article>
    </div>

    <h2>Current status</h2>
    <div class="grid">
      <article class="card">
        <strong>Q1 2026 baseline</strong>
        <ul>
          <li>102 total detected outcomes (60 high-signal, 42 low-signal).</li>
          <li>All day-zero outcomes are retrospective.</li>
          <li>Prospective outcomes at baseline: 0.</li>
        </ul>
      </article>
      <article class="card">
        <strong>Next planned update</strong>
        <ul>
          <li>Target: ~May 2026 (after ChEMBL 35 and CT.gov refresh).</li>
          <li>Quarterly updates are published in the scoreboard.</li>
        </ul>
      </article>
    </div>

    <h2>Query diseases</h2>
    <div class="card">
      <p class="small">Select a disease to inspect frozen predictions and tracked outcomes from slate <code>469bb270-a423-4929-96bd-6eaadeb7986b</code>.</p>
      <div id="diseaseChips" class="chip-row"></div>
      <div class="query-controls">
        <div>
          <label for="diseaseSelect">Disease</label>
          <select id="diseaseSelect"></select>
        </div>
        <div>
          <label for="drugFilter">Filter by drug name</label>
          <input id="drugFilter" type="text" placeholder="e.g., trazodone">
        </div>
        <div>
          <label for="tierFilter">Confidence tier</label>
          <select id="tierFilter">
            <option value="">All tiers</option>
            <option value="high">High</option>
            <option value="moderate">Moderate</option>
            <option value="exploratory">Exploratory</option>
          </select>
        </div>
        <div class="query-actions">
          <button id="clearFiltersBtn" class="btn" type="button">Clear filters</button>
        </div>
      </div>
      <p id="querySummary" class="small">Loading query dataset...</p>
      <div id="predictionsWrap"></div>
      <div id="outcomesWrap"></div>
    </div>

    <h2>Read the evidence</h2>
    <div class="grid">
      <article class="card">
        <strong>Core docs</strong>
        <ul>
          <li><a href="docs/SYSTEM.md">SYSTEM.md</a></li>
          <li><a href="docs/SCOREBOARD.md">SCOREBOARD.md</a></li>
          <li><a href="docs/HYPOTHESIS_REGISTRY.md">HYPOTHESIS_REGISTRY.md</a></li>
          <li><a href="docs/METRICS.md">METRICS.md</a></li>
          <li><a href="docs/REPLICATION.md">REPLICATION.md</a></li>
        </ul>
      </article>
      <article class="card">
        <strong>Data files</strong>
        <ul>
          <li><a href="slates/2026-Q1/registry.parquet">registry.parquet</a></li>
          <li><a href="slates/2026-Q1/outcomes.parquet">outcomes.parquet</a></li>
          <li><a href="slates/2026-Q1/query_data.json">query_data.json</a></li>
          <li><a href="slates/2026-Q1/slates.json">slates.json</a></li>
        </ul>
      </article>
      <article class="card">
        <strong>Narrative</strong>
        <ul>
          <li><a href="drafts/01_introducing_hypothesis_registry.md">Introducing the hypothesis registry</a></li>
          <li><a href="docs/examples/ALS_slate_walkthrough.md">ALS slate walkthrough</a></li>
          <li><a href="releases/2026_Q1_cross_disease_slate.md">Q1 2026 release note</a></li>
        </ul>
      </article>
    </div>

    <h2>Quick query</h2>
    <p>Run from repository root:</p>
    <p><code>python -c "import duckdb; print(duckdb.sql('select count(*) from read_parquet(\\'slates/2026-Q1/registry.parquet\\')').fetchall())"</code></p>

    <footer>
      This page is a lightweight index to the public evidence in this repository.
      For full methods and constraints, start with <a href="docs/SYSTEM.md">SYSTEM.md</a> and <a href="docs/REPLICATION.md">REPLICATION.md</a>.
    </footer>
  </main>
  <script>
    const diseaseSelect = document.getElementById("diseaseSelect");
    const drugFilter = document.getElementById("drugFilter");
    const tierFilter = document.getElementById("tierFilter");
    const clearFiltersBtn = document.getElementById("clearFiltersBtn");
    const diseaseChips = document.getElementById("diseaseChips");
    const querySummary = document.getElementById("querySummary");
    const predictionsWrap = document.getElementById("predictionsWrap");
    const outcomesWrap = document.getElementById("outcomesWrap");

    let queryData = null;

    function escapeHtml(value) {
      return String(value ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll("\"", "&quot;")
        .replaceAll("'", "&#039;");
    }

    function renderPredictions(predictions) {
      if (!predictions.length) {
        predictionsWrap.innerHTML = "<p class=\"small\">No predictions match this filter.</p>";
        return;
      }
      const rows = predictions.slice(0, 50).map((p) =>
        "<tr>" +
        "<td>" + escapeHtml(p.rank) + "</td>" +
        "<td>" + escapeHtml(p.drug_name) + "</td>" +
        "<td>" + escapeHtml(p.score) + "</td>" +
        "<td>" + escapeHtml(p.tier) + "</td>" +
        "</tr>"
      ).join("");

      predictionsWrap.innerHTML =
        "<h3>Predictions (top 50 shown)</h3>" +
        "<div class=\"table-wrap\"><table><thead><tr><th>Rank</th><th>Drug</th><th>Score</th><th>Tier</th></tr></thead><tbody>" +
        rows +
        "</tbody></table></div>";
    }

    function renderOutcomes(outcomes) {
      if (!outcomes.length) {
        outcomesWrap.innerHTML = "<p class=\"small\">No tracked outcomes for this disease in this slate.</p>";
        return;
      }
      const rows = outcomes.map((o) =>
        "<tr>" +
        "<td>" + escapeHtml(o.drug_name) + "</td>" +
        "<td>" + escapeHtml(o.type) + "</td>" +
        "<td>" + escapeHtml(o.source) + "</td>" +
        "<td>" + escapeHtml(o.date) + "</td>" +
        "</tr>"
      ).join("");

      outcomesWrap.innerHTML =
        "<h3>Tracked outcomes</h3>" +
        "<div class=\"table-wrap\"><table><thead><tr><th>Drug</th><th>Type</th><th>Source</th><th>Date</th></tr></thead><tbody>" +
        rows +
        "</tbody></table></div>";
    }

    function renderDiseaseChips() {
      if (!queryData) return;
      diseaseChips.innerHTML = queryData.diseases.map((d) => {
        const activeClass = d.key === diseaseSelect.value ? "chip active" : "chip";
        return "<button class=\"" + activeClass + "\" type=\"button\" data-disease=\"" + escapeHtml(d.key) + "\">" +
          escapeHtml(d.label) + "</button>";
      }).join("");
    }

    function renderQuery() {
      if (!queryData) return;
      const diseaseKey = diseaseSelect.value;
      const textFilter = drugFilter.value.trim().toLowerCase();
      const tier = tierFilter.value;

      const allPredictions = queryData.predictions_by_disease[diseaseKey] || [];
      const filteredPredictions = allPredictions.filter((p) => {
        const matchDrug = !textFilter || (p.drug_name || "").toLowerCase().includes(textFilter);
        const matchTier = !tier || p.tier === tier;
        return matchDrug && matchTier;
      });
      const outcomes = queryData.outcomes_by_disease[diseaseKey] || [];

      querySummary.textContent =
        "Showing " + filteredPredictions.length + " of " + allPredictions.length +
        " predictions and " + outcomes.length + " outcomes for selected disease.";

      renderDiseaseChips();
      renderPredictions(filteredPredictions);
      renderOutcomes(outcomes);
    }

    fetch("slates/2026-Q1/query_data.json")
      .then((response) => {
        if (!response.ok) throw new Error("Could not load query_data.json");
        return response.json();
      })
      .then((data) => {
        queryData = data;
        diseaseSelect.innerHTML = data.diseases.map((d) =>
          "<option value=\"" + escapeHtml(d.key) + "\">" + escapeHtml(d.label) + "</option>"
        ).join("");
        renderQuery();
      })
      .catch((error) => {
        querySummary.textContent = "Unable to load query dataset: " + error.message;
      });

    diseaseSelect.addEventListener("change", renderQuery);
    drugFilter.addEventListener("input", renderQuery);
    tierFilter.addEventListener("change", renderQuery);
    clearFiltersBtn.addEventListener("click", () => {
      drugFilter.value = "";
      tierFilter.value = "";
      renderQuery();
    });
    diseaseChips.addEventListener("click", (event) => {
      const target = event.target.closest("[data-disease]");
      if (!target) return;
      diseaseSelect.value = target.getAttribute("data-disease");
      renderQuery();
    });
  </script>
</body>
</html>
